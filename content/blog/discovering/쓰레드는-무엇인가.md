---
title: 쓰레드는 무엇인가
date: 2021-01-28 18:01:60
category: discovering
draft: false
---

# 쓰레드(Thread)에 대해 알아보자

#### 쓰레드(Thread)란?

프로그램의 실행 단위이며, 하나의 프로세스는 여러개의 쓰레드로 구성이 가능하다.

> 그럼 프로세스는요?
>
> 프로세스란, 단순히 실행중인 프로그램이라고 할 수있다.
>
> 즉, 사용자가 작성한 프로그램이 운영체제에 의해 메모리 공간을 할당받아 실행중인 것을 의미한다.
>
> 프로세스 : 프로그램이 사용되는 데이터 + 메모리 + 스레드로 구성된것이다.

프로세스는 운영체제로부터 자원을 할당받는 작업의 단위

쓰레드는 프로세스가 할당 받은 자원을 이용하는 실행의 단위이다.

멀티쓰레드 경우, 각각의 쓰레드는 독립된 작업을 수행하므로

쓰레드 : 스택 + PC 레지스터 값을 가지고 있다.

##### 왜 스택은 독립적으로 할당 받나요?

스택 : 함수 호출시 전달 되는 인자, 되돌아갈 주소값, 변수 등을 저장하기 위한 메모리 공간

이렇게 독립된 함수 호출 == 독립적인 실행 가능 => 독립된 스택

##### PC레지스터 역시 독립적 할당!

쓰레드는 CPU를 할당 받았다가, 스케줄러에 의해 다시 선점되므로, 어디까지 수행했는지 기록이 필요하다 => 즉, PC레지스터 역시 독립적으로 가지고 있어야한다.

##### 쓰레드의 장점

쓰레드는 프로세스보다 생성, 종료, 전환시간이 짧다

쓰레드는 프로세스의 메모리 자원등을 공유하므로 커널의 도움 없이 상호간에 통신가능하다.

#### 쓰레드 동기화 방법을 알아보자

##### Mutex/Semaphore/Monitor

##### Mutex

1.  쓰레드의 동시접근을 허용하지 않는다.

2.  뮤텍스 방법은 임계영역에 들어가기 위해 뮤텍스를 가지고 있어야만한다.

    -- 임계영역 : 두개의 쓰레드가 동시에 실행도리 경우 문제가 발생할 수 있는데, 이러한 문제를 일으킬 수 있는 코드 블럭을 의미

##### Semaphore

1. 뮤텍스와 비슷하지만 접근 순서 동기화에 관련이 있다.

##### Monitor

1. Mutex와 Condition Variable(Queue)를 가지고 있는 Synchronization 메커니즘

> Mutex와 Monitor는 상호 배제 하여 임계구역에 하나의 쓰레드만 가능!
>
> Semaphore는 하나의 쓰레드만 들어가게 하거나, 여러개도 들어가게 할 수 있음!

##### 뮤텍스와 모니터의 차이?

1. 뮤텍스는 다른 프로세스와 동기화를 위해 사용 2. 모니터는 하나의 프로세스 내에 다른 쓰레드간 동기화 할 때 사용 3. 뮤텍스는 운영체제 커널에서, 모니터는 프레임워크나 라이브러리 에서 제공 4. 뮤텍스는 무겁고 느리며 // 모니터는 가볍고 빠르다

##### 세마포어와 모니터의 차이는?

1. JAVA에서 모니터의 모든 객체를 기본적으로 제공
2. 세마포어의 경우 카운터라는 변수값을 상호배제, 정렬의 목적으로 매번 값을 설정해줘야하는 번거로움이 있음
3. 모니터는 캡슐화되어있기때문에, 편하게 동기화 가능

##### 뮤텍스와 세마포어차이?

1. 뮤텍스는 1개만 동기화 되지만, 세마포어는 하나 이상을 동기화 할 수 있다.

```
비유가 적절한 글

변기가 하나뿐인 화장실에서는
앞의 사람이 볼일을 마치고 나가야 다음 사람이 들어갈 수 있다.
이렇게 한번에 오직 하나만 처리할 수 있는 대상에 사용하는 것이 뮤텍스이다.

변기가 세개인 화장실에서는 동시에 세 사람이 볼일을 볼 수 있고
이 세 사람 중 아무나 한명이 나오면 다음 사람이 볼일을 볼 수 있다.
이렇게 동시에 제한된 수의 여러 처리가 가능하면 세마포어이다.

만약 변기 세개짜리 화장실의 각 변기에 대해 뮤텍스를 사용한다면
대기중인 사람은 각 변기 앞에 줄을 서는 것이고
이렇게 되면 옆 칸이 비어도 들어가지 못하게 된다.

```

https://goodgid.github.io/What-is-Thread/
